<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
	    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
		<title></title>
		   <link rel="icon" href="img/logo.png" type="image/x-icon"/>
		<script type="text/javascript" src="js/jquery-3.2.1.min.js"></script>
		<script type="text/javascript" src="js/jquery.session.js"></script>
		<style>
			* {
				margin: 0;
				padding: 0;
			}
			
			.box {
				width: 100%;
				height: 100%;
			}
			
			.top {
				width: 100%;
				height: 50px;
				background-color: #019ed5;
			}
			
			.top1 {
				width: 100px;
				height: 50px;
				line-height: 50px;
				text-align: center;
				float: right;
				color: white;
			}
			
			.top2 {
				width: 60%;
				height: 40px;
				margin-left: 20%;
				margin-top: 100px;
				line-height: 40px;
				text-align: center;
				font: 24px "微软雅黑";
			}
			
			.center {
				width: 60%;
				height: 40px;
				margin-left: 20%;
				margin-top: 10px;
				text-align: center;
				line-height: 40px;
			}
			
			.center2 {
				width: 60%;
				height: 40px;
				margin-left: 20%;
				margin-top: 10px;
				text-align: center;
				line-height: 40px;
			}
			
			.tm {
				width: 100px;
				height: 35px;
				line-height: 35px;
				float: left;
				margin-left: 27%;
			}
			
			.center input {
				width: 300px;
				height: 35px;
				line-height: 35px;
				outline: 0;
				float: left;
				border-bottom-style: solid;
				border-top-style: hidden;
				border-left-style: hidden;
				border-right-style: hidden;
			}
			
			#register {
				width: 400px;
				height: 35px;
				line-height: 35px;
				margin-left: 28%;
				background-color: black;
				border-radius: 10px;
				color: white;
			}
			
			#chose {
				width: 300px;
				height: 35px;
				line-height: 35px;
				float: left;
			}
			
			#chose input {
				width: 100px;
			}
		</style>

	</head>

	<body>
		<div class="top">
			<div class="top1">返回首页</div>
		</div>
		<div id="box">
			<div class="top2">业务员基本信息</div>
			<div class="center">
				<div class="tm">姓名:</div><input type="text" id="name"></div>
			<div class="center2">
				<div class="tm">性别:</div>
				<div id="chose"><input type="radio" value="1" name="sex" id="rad">男&nbsp;&nbsp;&nbsp;
					<input type="radio" value="0" name="sex" id="rad4">女</div>
			</div>
			<div class="center">
				<div class="tm">身份证号:</div><input type="text" id="number"></div>
			<div class="center">
				<div class="tm">手机号码:</div><input type="text" id="tel"></div>
			<div class="center">
				<div class="tm">qq:</div><input type="text" id="qq"></div>
			<div class="center">
				<div class="tm">微信:</div><input type="text" id="wx"></div>
			<div class="center">
				<div class="tm">邮箱:</div><input type="text" id="email" name="email"></div>
			<div class="center">
				<div class="tm">地址:</div><input id="dizhi"></div>
			<div class="center2">
				<div id="register">确认修改</div>
			</div>
			<div>
	</body>
	<script type="text/javascript" src="js/canvas-nest.js"></script>
	<script type="text/javascript" color="255,0,0" opacity="0.5" count="600" src="canvas-nest.js"></script>
	<script type="text/javascript">
		$(".top1").on("click", function() {
			window.location.href = "http://www.uminfo.cn/yindex.html";
		});
		var sales_id = $.session.get('userid');
	
		if(sales_id == null || sales_id == "") {
			window.location.href = "http://www.uminfo.cn/yindex.html";
		} else {
			$.ajax({
				url: "http://api.uminfo.cn/sales.php/sales?sales_id=" + sales_id,
				dataType: 'json',
				type: 'get',
				ContentType: "application/hson;charset=utf-8",
				data: JSON.stringify({}),
				success: function(msg) {
					// console.log(msg);
					$("#h3").html(msg.sales.sales_name);
					$("#name").val(msg.sales.sales_name);
					$("#number").val(msg.sales.card_id);
					$("#tel").val(msg.sales.telephone);
					$("#qq").val(msg.sales.qq);
					$("#wx").val(msg.sales.weixin);
					$("#email").val(msg.sales.zip_code);
					$("#dizhi").val(msg.sales.address);
					if(msg.sales.sex == 0) {
						$('input:radio:last').attr('checked', 'checked');
					} else {
						$('input:radio:first').attr('checked', 'checked');
					}
				},
				error: function(xhr) {
					alert("获取后台失败" + xhr.responseText);
				}
			})
		}
		//修该sales个人信息
		$("#register").on("click", function() {
			var sales_id = $.session.get('userid');
			var sales_name = $("#name").val();
			var numb = $("#number").val();
			var tel = $("#tel").val();
			var qq1 = $("#qq").val();
			var wx1 = $("#wx").val();
			var em = $("#email").val();
			var di = $("#dizhi").val();
			var sex = $("input[name='sex']:checked").val();
			if(!/^1[34578]\d{9}$/.test(tel)) {
				alert("电话号码格式不对");
			} else if(!/^\d{15}|\d{18}$/.test(numb)) {
				alert("身份证格式不对");
			} else {
				//修改用户信息
				$.ajax({
					url: "http://api.uminfo.cn/sales.php/sales",
					dataType: 'json',
					type: 'put',
					ContentType: "application/json;charset=utf-8",
					data: JSON.stringify({
						sales_id: sales_id,
						sales_name: sales_name,
						sex: sex,
						card_id: numb,
						telephone: tel,
						address: di,
						zip_code: em,
						qq: qq1,
						weixin: wx1
					}),
					success: function(msg) {
						alert(msg.desc);
						window.location.reload();
					},
					error: function(xhr) {
						alert("获取后台信息失败" + xhr.responseText);
					}
				});
			}
		})
	</script>

</html>